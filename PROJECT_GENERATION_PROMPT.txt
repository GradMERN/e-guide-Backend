# Project Generation Prompt

## Project Overview
Create a backend API for a digital tour guide platform called **E-Tour Guide**. The platform allows users to enroll in tours, access tour content, and make payments. Guides can create and manage tours, while admins oversee the system. The API should include authentication, role-based access control, and payment integration.

---

## Use Cases

### 1. **User Authentication**
- **Local Login:** Users can register and log in using email and password.
- **Google OAuth:** Users can log in using their Google accounts.
- **Email Verification:** Send verification emails upon registration.
- **Password Reset:** Allow users to reset their passwords via email.

### 2. **User Management**
- **Profile Management:** Users can view and update their profiles.
- **Change Password:** Users can change their passwords.
- **Delete Account:** Users can delete their accounts.

### 3. **Admin Features**
- **User Management:** Admins can view, update roles, and delete user accounts.
- **Dashboard Stats:** Admins can view system statistics (e.g., total users, enrollments).

### 4. **Tour Management**
- **Create Tours:** Guides can create tours with details like name, description, price, and images.
- **Update/Delete Tours:** Guides can update or delete their tours.
- **View Tours:** Users can view all available tours.

### 5. **Enrollment Management**
- **Enroll in Tours:** Users can enroll in tours.
- **View Enrollments:** Users can view their enrollments, grouped by status (e.g., in-progress, available).

### 6. **Payment Integration**
- **Stripe Integration:**
  - Create PaymentIntents for tour enrollments.
  - Handle Stripe webhooks to update payment and enrollment statuses.
- **Payment Records:** Store payment details in the database.

### 7. **Place Management**
- **CRUD Operations:** Guides can create, update, delete, and view places.

### 8. **Tour Content Management**
- **Tour Items:** Guides can add items (e.g., images, audio) to tours.
- **Access Control:** Only enrolled users can access tour content.

### 9. **Reviews**
- **Add Reviews:** Users can leave reviews for tours.
- **Aggregate Ratings:** Automatically calculate average ratings for tours.

### 10. **Notifications**
- **Email Notifications:**
  - Notify users about profile updates.
  - Send payment confirmation emails.

---

## Technical Requirements

### 1. **Backend Framework**
- Use **Node.js** with **Express.js**.

### 2. **Database**
- Use **MongoDB** with **Mongoose** for schema modeling.

### 3. **Authentication**
- Use **JWT** for authentication.
- Hash passwords using **bcrypt**.

### 4. **Payment Integration**
- Integrate **Stripe** for payment processing.
- Secure webhooks with signature verification.

### 5. **Validation**
- Use **Zod** for request validation.

### 6. **File Uploads**
- Use **Multer** for uploading images and audio files.

### 7. **Error Handling**
- Implement a global error handler.
- Log errors for debugging.

### 8. **Environment Variables**
- Use a `.env` file for sensitive data (e.g., `MONGO_URI`, `JWT_SECRET`, `STRIPE_SECRET_KEY`).

### 9. **Testing**
- Write unit and integration tests using **Jest** or **Mocha**.

### 10. **Documentation**
- Document the API using **Swagger** or Postman collections.

---

## Folder Structure
```
project-root/
├── src/
│   ├── app.js
│   ├── server.js
│   ├── config/
│   │   ├── database.config.js
│   │   ├── passport.config.js
│   ├── controllers/
│   │   ├── auth.controller.js
│   │   ├── user.controller.js
│   │   ├── admin.controller.js
│   │   ├── tour.controller.js
│   │   ├── enrollment.controller.js
│   │   ├── payment.controller.js
│   │   ├── place.controller.js
│   ├── middlewares/
│   │   ├── authentication.middleware.js
│   │   ├── authorization.middleware.js
│   │   ├── error-handler.middleware.js
│   │   ├── fileUpload.middleware.js
│   ├── models/
│   │   ├── user.model.js
│   │   ├── tour.model.js
│   │   ├── enrollment.model.js
│   │   ├── payment.model.js
│   │   ├── place.model.js
│   ├── routes/
│   │   ├── auth.route.js
│   │   ├── user.route.js
│   │   ├── admin.route.js
│   │   ├── tour.route.js
│   │   ├── enrollment.route.js
│   │   ├── payment.route.js
│   │   ├── place.route.js
│   ├── utils/
│   │   ├── apiFeatures.js
│   │   ├── hashing.utils.js
│   │   ├── jwt.utils.js
│   │   ├── send-email.util.js
│   ├── validators/
│   │   ├── auth.validator.js
│   │   ├── user.validator.js
│   │   ├── admin.validator.js
│   │   ├── place.validator.js
├── public/
│   ├── tours/
├── .env
├── package.json
```

---

## Additional Notes
- Ensure the project is modular and follows best practices.
- Use modern JavaScript (ES6+) features.
- Prioritize security and scalability.